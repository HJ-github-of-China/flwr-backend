基于你的数据库设计和需求，我来为你设计一个完整的Python后端接口文档：

## 📋 API 接口文档

### 1. 获取模型训练指标数据

**接口说明**：获取指定模型的训练指标数据，用于生成折叠折线图

**请求路径**：`/api/models/{model_id}/training-metrics`

**请求方法**：GET

**请求参数**：

| 参数名 | 位置 | 类型 | 必填 | 说明 |
|--------|------|------|------|------|
| model_id | path | integer | 是 | 模型ID |
| start_epoch | query | integer | 否 | 起始轮次，默认1 |
| end_epoch | query | integer | 否 | 结束轮次，默认全部 |

**请求示例**：
```http
GET /api/models/1001/training-metrics?start_epoch=1&end_epoch=10
```

**响应结果**：
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "model_info": {
      "model_id": 1001,
      "model_name": "ResNet50-Classification",
      "description": "Image classification model for medical X-ray"
    },
    "metrics_data": {
      "epochs": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
      "loss": [1.832, 1.221, 0.912, 0.745, 0.642, 0.578, 0.531, 0.499, 0.472, 0.830],
      "accuracy": [32.145, 48.772, 58.334, 64.889, 68.776, 70.912, 71.889, 72.334, 72.667, 71.930],
      "recall": [18.23, 32.45, 42.78, 49.11, 53.22, 55.67, 56.98, 57.66, 58.01, 58.02],
      "prec": [25.67, 38.91, 47.33, 53.78, 57.89, 59.44, 60.12, 60.55, 60.78, 60.92],
      "f1": [21.33, 35.41, 44.92, 51.34, 55.47, 57.49, 58.51, 59.07, 59.36, 59.43]
    },
    "chart_config": {
      "title": "模型训练指标趋势",
      "legend": ["损失函数", "准确率", "召回率", "精确率", "F1分数"],
      "x_axis": ["第1轮", "第2轮", "第3轮", "第4轮", "第5轮", "第6轮", "第7轮", "第8轮", "第9轮", "第10轮"]
    }
  }
}
```

### 2. 获取ECharts配置格式数据

**接口说明**：直接返回ECharts可用的配置格式

**请求路径**：`/api/models/{model_id}/training-metrics/chart`

**请求方法**：GET

**请求参数**：

| 参数名 | 位置 | 类型 | 必填 | 说明 |
|--------|------|------|------|------|
| model_id | path | integer | 是 | 模型ID |
| metrics | query | string | 否 | 指定指标，多个用逗号分隔，如：loss,accuracy,f1 |

**请求示例**：
```http
GET /api/models/1001/training-metrics/chart?metrics=loss,accuracy,recall,prec,f1
```

**响应结果**：
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "title": {
      "text": "模型训练指标趋势"
    },
    "tooltip": {
      "trigger": "axis"
    },
    "legend": {
      "data": ["损失函数", "准确率", "召回率", "精确率", "F1分数"]
    },
    "grid": {
      "left": "3%",
      "right": "4%",
      "bottom": "3%",
      "containLabel": true
    },
    "toolbox": {
      "feature": {
        "saveAsImage": {}
      }
    },
    "xAxis": {
      "type": "category",
      "boundaryGap": false,
      "data": ["第1轮", "第2轮", "第3轮", "第4轮", "第5轮", "第6轮", "第7轮", "第8轮", "第9轮", "第10轮"]
    },
    "yAxis": {
      "type": "value"
    },
    "series": [
      {
        "name": "损失函数",
        "type": "line",
        "data": [1.832, 1.221, 0.912, 0.745, 0.642, 0.578, 0.531, 0.499, 0.472, 0.830]
      },
      {
        "name": "准确率",
        "type": "line",
        "data": [32.145, 48.772, 58.334, 64.889, 68.776, 70.912, 71.889, 72.334, 72.667, 71.930]
      },
      {
        "name": "召回率",
        "type": "line",
        "data": [18.23, 32.45, 42.78, 49.11, 53.22, 55.67, 56.98, 57.66, 58.01, 58.02]
      },
      {
        "name": "精确率",
        "type": "line",
        "data": [25.67, 38.91, 47.33, 53.78, 57.89, 59.44, 60.12, 60.55, 60.78, 60.92]
      },
      {
        "name": "F1分数",
        "type": "line",
        "data": [21.33, 35.41, 44.92, 51.34, 55.47, 57.49, 58.51, 59.07, 59.36, 59.43]
      }
    ]
  }
}
```



## 🔧 错误响应格式

所有接口错误时返回统一格式：

```json
{
  "code": 404,
  "message": "模型不存在",
  "data": null
}
```

常见错误码：
- 200: 成功
- 201: 创建成功
- 400: 请求参数错误
- 404: 资源不存在
- 409: 数据冲突（如epoch重复）
- 500: 服务器内部错误

这样的设计既满足了前端ECharts图表的数据需求，又提供了灵活的查询和操作接口。


基于你提供的数据库设计，我来总结一下你的库表设计：

## 📊 数据库设计总结

### 1. 表结构概览

**表名**: `training_metrics` (训练指标表)

### 2. 字段设计分析

| 字段名 | 类型 | 约束 | 说明                      |
|--------|------|------|-------------------------|
| `id` | BIGINT AUTO_INCREMENT | PRIMARY KEY | 自增主键，标准设计               |
| `model_id` | BIGINT | NOT NULL, FOREIGN KEY | 模型ID, 不要使用外键直接关联models表 |
| `epoch` | INT | NOT NULL | **训练轮次**，核心维度字段         |
| `loss` | DECIMAL(10,6) | NOT NULL | 损失值，高精度(6位小数)           |
| `accuracy` | DECIMAL(6,3) | NOT NULL | 准确率，百分比格式               |
| `recall` | DECIMAL(6,3) | NOT NULL | 召回率，百分比格式               |
| `prec` | DECIMAL(6,3) | NOT NULL | 精确率(避免关键字)              |
| `f1` | DECIMAL(6,3) | NOT NULL | F1分数，百分比格式              |
| `created_at` | DATETIME | DEFAULT CURRENT_TIMESTAMP | 创建时间                    |

### 3. 关键设计特点

#### ✅ **优点**:
1. **关系完整性**: 通过外键关联models表，确保数据一致性
2. **唯一性约束**: `(model_id, epoch)` 组合唯一，防止重复轮次数据
3. **精度合理**: 
   - Loss: 10位整数+6位小数，适合深度学习损失值
   - 指标: 6位整数+3位小数，满足百分比精度需求
4. **时间追踪**: 自动记录数据创建时间
5. **命名规范**: 字段名简洁明确，避免SQL关键字冲突

#### 🔍 **业务语义**:
- **纵向扩展**: 支持同一模型多轮次训练数据存储
- **横向对比**: 便于不同模型间的训练效果对比
- **时序分析**: 按epoch顺序展示训练过程趋势

### 4. 索引设计
- **主键索引**: `id` (聚类索引)
- **唯一索引**: `uq_model_epoch` (模型+轮次)
- **外键索引**: `model_id` (自动创建)

### 5. 适用场景
🎯 **完美适配**: 
- 机器学习模型训练过程监控
- 训练指标可视化(如ECharts折线图)
- 模型性能分析和比较
- 训练过程回溯和调试

### 6. 扩展考虑
```sql
-- 未来可能的扩展
CREATE INDEX idx_created_at ON training_metrics(created_at);
CREATE INDEX idx_model_metrics ON training_metrics(model_id, epoch, loss, accuracy);
```

### 7. 数据示例解读
从你的示例数据可以看出典型的训练过程：
- 📉 **Loss**: 逐渐下降后略有反弹(可能过拟合)
- 📈 **Accuracy**: 快速提升后趋于稳定
- 📊 **其他指标**: 同步提升，符合预期训练规律

## 🎯 总结
这是一个**设计优良**的机器学习训练指标存储方案，具有：
- **完整性** - 包含所有关键训练指标
- **规范性** - 符合数据库设计范式
- **实用性** - 直接支持前端可视化需求
- **扩展性** - 为未来功能预留了空间

这个设计完全能够支撑你前端的折叠折线图展示需求！